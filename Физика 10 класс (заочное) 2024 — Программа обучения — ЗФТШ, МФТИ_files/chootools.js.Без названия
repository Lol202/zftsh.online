if("undefined"===typeof console){var console={};console.log=console.error=console.info=console.debug=console.warn=console.trace=console.dir=console.dirxml=console.group=console.groupEnd=console.time=console.timeEnd=console.assert=console.profile=function(){}}Events.implement({getEvents:function(b){b=Events.removeOn(b);var d;b||(d=this.$events);$type(this.$events[b])&&(d=this.$events[b]);if(!d||1>d.length)d=!1;return d},hasEvents:function(b){return 0!=this.getEvents(b)}});
Native.implement([Element,Window,Document],{getEvents:function(b){var d=this.retrieve("events");if(b&&!$type(d[b]))return!1;b&&(d=d[b]);return!d||1>d.length?!1:d},hasEvents:function(b){return 0!=this.getEvents(b)}});
(function(){var b=0;Date.setServerOffset=function(a){b=new Date(a)-new Date};Date.getServerOffset=function(){return b};Date.implement({getISODay:function(){var a=this.get("day")-1;0>a&&(a+=7);return a},getISOWeek:function(){var a=this.clone().set({month:1,date:4}),a=a.get("dayofyear")-a.getISODay()-1;return((this.get("dayofyear")-a)/7).ceil()},getFluentTimeSince:function(a){a||(a=new Date);var d=(this-a-b)/1E3,c=Math.abs(d),d=0<d;return 1>c?en4.core.language.translate("now"):60>c?d?en4.core.language.translate("in few seconds"):
    en4.core.language.translate("a few seconds ago"):3600>c?(a=Math.floor(c/60),d?en4.core.language.translate(["in %s minute","in %s minutes",a],a):en4.core.language.translate(["%s minute ago","%s minutes ago",a],a)):43200>c||86400>c&&this.get("day")==a.get("day")?(a=Math.floor(c/3600),d?en4.core.language.translate(["in %s hour","in %s hours",a],a):en4.core.language.translate(["%s hour ago","%s hours ago",a],a)):604800>c&&this.getISOWeek()==a.getISOWeek()?en4.core.language.translate("%s at %s",this.format("%A"),
    this.format("%I %p")):1897344E3>c&&this.getYear()==a.getYear()?this.format("%B %d%o").replace(" 0"," "):this.format("%B %d%o %Y")}});


    window.addEvent('load', function()
    {
        (function(){
            var now = new Date();
            $$('.timestamp-update').each(function(element){
                var ref = new Date( element.hasAttribute('data-timestamp') ? parseInt(element.getAttribute('data-timestamp'))*1000 : element.title );
                var newStamp = ref.getFluentTimeSince(now);
                if( element.innerHTML != newStamp )
                {
                    element.innerHTML = newStamp;
                }
            });
        }).periodical(1000);
    });


    var d=new Class({Implements:[Options,Events],options:{useNullHeightShrink:!0,interval:!1},_resizing:!1,_interval:!1,_debug:!1,initialize:function(a,b){this.textarea=
    $(a);this.setOptions(b);this._debug&&(this._debug=new Element("div",{styles:{position:"absolute",top:"30px",left:"30px"}}),this._debug.inject(document.body));this.textarea.setStyles({"overflow-x":"auto","overflow-y":"hidden","-mox-box-sizing":"border-box","-ms-box-sizing":"border-box",resize:"none","padding-bottom":"0px","padding-top":"4px","padding-left":"4px"});this.textarea.store("AutoGrowInstance",this);this.textarea.addEvent("focus",this.handle);this.textarea.addEvent("keyup",this.handle);this.textarea.addEvent("paste",
    this.handle);this.textarea.addEvent("cut",this.handle);(Browser.Engine.webkit||Browser.Engine.trident)&&this.textarea.addEvent("scroll",this.handle);this.options.interval?this._interval=this.handle.periodical(this.options.interval,this.textarea):this.resize()},handle:function(){var a=this.retrieve("AutoGrowInstance");a&&a.resize()},resize:function(){this._resizing||(this._resizing=!0,this._resize(),(Browser.Engine.gecko||Browser.Engine.webkit)&&this._shrink(),this._resizing=!1)},_resize:function(){var a=
    this.textarea.getScrollSize().y;if(a){var b=this._getHeight(),c=this.textarea.getSize().y;this._debug&&(this._debug.innerHTML="Old: "+c+"<br />Scroll: "+a+"<br />New: "+b+"<br />");b!=c&&(this.textarea.style.maxHeight=this.textarea.style.height=b+"px")}else this._estimate()},_getHeight:function(){var a=this.textarea.getScrollSize().y;Browser.Engine.gecko?a+=this.textarea.offsetHeight-this.textarea.clientHeight:Browser.Engine.trident?a+=this.textarea.offsetHeight-this.textarea.clientHeight:Browser.Engine.webkit?
    a+=this.textarea.getStyle("border-top-width").toInt()+this.textarea.getStyle("border-bottom-width").toInt():Browser.Engine.presto&&(a+=this.textarea.getStyle("padding-bottom").toInt());return a},_shrink:function(){if(this.options.useNullHeightShrink)this.textarea.style.height="0px",this._resize();else{var a=this.textarea.getScrollSize().y,b=this.textarea.getStyle("padding-bottom").toInt();this.textarea.style.paddingBottom=b+1+"px";var c=this._getHeight()-1;this.textarea.getStyle("max-height").toInt()!=
c&&(this.textarea.style.paddingBottom=b+a+"px",this.textarea.scrollTop=0,this.textarea.style.maxHeight=this._getHeight()-a+"px");this.textarea.style.paddingBottom=b+"px"}},_estimate:function(){this.textarea.style.maxHeight="";this.textarea.style.height="auto";this.textarea.rows=(this.textarea.value.match(/(\r\n?|\n)/g)||[]).length+1},clear:function(){this.textarea.removeEvent("focus",this.handle);this.textarea.removeEvent("keyup",this.handle);this.textarea.removeEvent("paste",this.handle);this.textarea.removeEvent("cut",
    this.handle);(Brower.Engine.webkit||Browser.Engine.trident)&&this.textarea.removeEvent("scroll",this.handle);$clear(this._interval)}});Element.implement({autogrow:function(a){a?this.store("AutoGrowOptions",a):a=this.retrieve("AutoGrowOptions");this.retrieve("AutoGrowInstance")&&this.retrieve("AutoGrowInstance").clear();new d(this,a);return this}})})();
String.implement({replaceLinks:function(){return this.replace(/http\:\/\/\w[^\s<>'"]+/ig,function(b){return'<a href="'+encodeURI(b)+'" target="_blank">'+b.escapeQuotes()+"</a>"}.bind(this))},cTrim:function(b){return b?this.replace(new RegExp("^["+b+"]+|["+b+"]+$","g"),""):this},allIndexesOf:function(b){var d=[],a=-1,g=100;do a=this.indexOf(b,a+1),-1!=a&&d.push(a),g--;while(-1!=a&&0<g);return d},stripTags:function(){return this.replace(/<[^<>]+?>/g)},escapeHTML:function(){var b=document.createElement("div"),
    d=document.createTextNode(this);b.appendChild(d);return b.innerHTML},htmlSpecialChars:function(){return this.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;").replace("'","&#039;")},escapeQuotes:function(){return this.replace('"','"').replace("'","\\'")}});
Element.implement({enableViewMore:function(){if(this.retrieve("ChooViewMore",!1))return this;this.store("ChooViewMore",!0);var b=this.get("html");if(255>b.length)return this;1027<b.length&&(b=b.substring(0,1027)+" ...");var d=new Element("span",{html:b.substring(0,255)}),a=new Element("span",{html:b,styles:{display:"none"}}),b=new Element("a",{href:"javascript:void(0);",html:" more",events:{click:function(){d.style.display="none";a.style.display=""}}});this.empty();d.inject(this);a.inject(this);b.inject(d);
  return this},enableLinks:function(){try{var b=RegExp("(([\\w]{3,}:)(\\/\\/)?)([\\w\\d$_.+!*'(),-]+(:[\\w\\d$_.+!*'(),-]+)?@)?((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])|(([a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.|[a-zA-Z0-9])*([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9]))(:\\d+)?(/[\\w\\d$_.+!*'(),;/:@&=-]*)?(\\?[\\w\\d$_.+!*'(),;/:@&=-]*)?(#[\\w\\d$_.+!*'(),;/:@&=-]*)?","ig")}catch(d){return this}[this].combine(this.getElements("*")).each(function(a){try{if("element"!=
    $type(a.getParent("a"))){var d=[],c,f;c=0;for(f=a.childNodes.length;c<f;c++)3==a.childNodes[c].nodeType&&"string"==$type(a.childNodes[c].nodeValue)&&d.push(a.childNodes[c]);if(!(0>=d.length))for(c=0,f=d.length;c<f;c++){var e=d[c],h=e.nodeValue,l;try{l=h.match(b)}catch(u){continue}if(!("array"!=$type(l)||0>=l.length)){for(var m=a=0,q=l.length;m<q;m++){for(var k=l[m],r=k.substring(k.length-1);-1!==".,;:?!".indexOf(r);)k=k.substring(0,k.length-1),r=k.substring(k.length-1);var n=h.indexOf(k,a);if(-1!=
    n){var p=h.substring(a,n);e.parentNode.insertBefore(document.createTextNode(p),e);e.parentNode.insertBefore(new Element("a",{href:k,target:"_blank",html:k}),e);a=n+k.length;m==q-1&&(p=h.substring(a),e.parentNode.insertBefore(document.createTextNode(p),e))}}e.parentNode.removeChild(e)}}}}catch(t){"console"in window&&"log"in console&&console.log(t)}});return this}});
(function(){var b=window.IdleWatcher=new Class({Implements:[Options,Events],options:{timeout:2E4,poll:500},time:0,state:1,interval:!1,initialize:function(b,a){this.observer=b||window;this.setOptions(a);this.time=$time()},register:function(){window.addEvents({scroll:this.onActive.bind(this),resize:this.onActive.bind(this)});document.addEvents({mousemove:this.onActive.bind(this),keydown:this.onActive.bind(this)});this.interval=this.poll.periodical(this.options.poll,this)},unregister:function(){window.removeEvents({scroll:this.onActive.bind(this),
  resize:this.onActive.bind(this)});document.removeEvents({mousemove:this.onActive.bind(this),keydown:this.onActive.bind(this)})},onActive:function(b){0==this.state&&(this.state=1,b=$time()-this.time,this.observer.fireEvent("onStateActive",{time:b}));this.time=$time()},poll:function(){1==this.state&&$time()-this.time>this.options.timeout&&(this.state=0,this.observer.fireEvent("onStateIdle"))}});(window._IdleWatcher=new b).register()})();
function fix_gecko_select_all_contenteditable_bug(b,d){if(Browser.Engine.gecko){var a=window.getSelection();if(a){b.focus();b.appendChild(document.createTextNode(""));var g=a.getRangeAt(0);g.setStart(b.firstChild,0);g.setEnd(b.lastChild,b.lastChild.length);a.removeAllRanges();a.addRange(g);d.stop()}}}
function htmlspecialchars_decode(b,d){var a=0,g=0,c=!1;"undefined"===typeof d&&(d=2);b=b.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var f={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};0===d&&(c=!0);if("number"!==typeof d){d=[].concat(d);for(g=0;g<d.length;g++)0===f[d[g]]?c=!0:f[d[g]]&&(a|=f[d[g]]);d=a}d&f.ENT_HTML_QUOTE_SINGLE&&(b=b.replace(/&#0*39;/g,"'"));c||(b=b.replace(/&quot;/g,'"'));return b=b.replace(/&amp;/g,"&")}
String.implement({vsprintf:function(b){str=this;if(!b||!b.length)return str;for(var d="",a,g=0,c,f,e,h;0<str.length;){if(!str.match(/[%]/)){d+=str;break}if(a=str.match(/^([^%]+?)([%].+)?$/))if(d+=a[1],str=typeof a[2]?a[2]:"",""==str)break;if("%%"==str.substring(0,2))str=str.substring(2),d+="%";else if(a=str.match(/^[%](?:([0-9]+)\x24)?(\x2B)?(\x30|\x27[^$])?(\x2D)?([0-9]+)?(?:\x2E([0-9]+))?([bcdeEfosuxX])/)){f=a[7];e=a[6]||!1;h=a[2]||!1;c=a[1]?a[1]-1:g++;if($type(b[c]))c=b[c];else throw"Undefined argument for index "+
c;switch(typeof c){case "number":case "string":case "boolean":break;case "undefined":if(null==c){c="";break}default:throw"Unknown argument type: "+typeof c;}switch(f){case "b":"number"!=typeof c&&(c=parseInt(c));c=c.toString(2);break;case "c":c=String.fromCharCode(c);break;case "d":c=parseInt(c);break;case "E":case "e":"number"!=typeof c&&(c=parseFloat(c));c=e?c.toExponential(e):c.toExponential();"E"==f&&(c=c.toUpperCase());break;case "u":c=Math.abs(parseInt(c));break;case "f":c=e?parseFloat(c).toFixed(e):
    parseFloat(c);break;case "o":"number"!=typeof c&&(c=parseInt(c));c=c.toString(8);break;case "s":"string"!=typeof c&&(c=String(c));e&&(c=c.substring(0,e));break;case "x":case "X":"number"!=typeof c&&(c=parseInt(c)),c=c.toString(8),"X"==f&&(c=c.toUpperCase())}("d"==f||"e"==f||"f"==f)&&h&&0<c&&(c="+"+c);f=a[3]?a[3]:" ";e=a[5]?a[5]:0;e-=c.length;if(0<e){for(h="";0<e;)h+=f,e--;f=h;d=a[4]?d+(c+f):d+(f+c)}else d+=c;str=str.substring(a[0].length)}else throw"Malformed expression in string: "+str;}return d},
  sprintf:function(){return this.vsprintf(arguments)}});
Request.Post=new Class({url:!1,data:!1,options:{formOptions:{target:null,enctype:null,method:"post"}},form:!1,initialize:function(b){if(!("url"in b))throw"no url given";this.url=b.url;delete b.url;"data"in b&&(this.data=b.data,delete b.data);this.options=$merge(this.options,b);this.render()},send:function(){this.render();this.form.submit()},render:function(){if(this.form)return this;this.form=new Element("form",$merge(this.options.formOptions,{action:this.url,styles:{display:"none"}}));this.form.inject(document.body);
  this._recursiveRender(this.data);return this},_recursiveRender:function(b,d){"array"!=$type(d)&&(d=[]);var a=[].extend(d);switch($type(b)){case "collection":case "array":$A(b).each(function(b,c){a=[].extend(d);a.push(c);this._recursiveRender(b,a)}.bind(this));break;case "object":$H(b).each(function(b,c){a=[].extend(d);a.push(c);this._recursiveRender(b,a)}.bind(this));break;case "element":b.get("value")&&this._recursiveRender(b.get("value"),a);break;case "event":this._recursiveRender($(b.target),a);
  break;case "textnode":this._recursiveRender(b.nodeValue,a);break;case "function":this._recursiveRender(b(),a);break;case "string":case "number":case "date":case "boolean":this._renderOne(b,a)}},_renderOne:function(b,d){(new Element("input",{type:"hidden",name:this._buildElementName(d),value:b})).inject(this.form);return this},_buildElementName:function(b){var d="";b.each(function(a,b){d=""==d?a:d+("["+a+"]")});return d}});